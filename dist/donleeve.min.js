window.Donleeve=function(){function n(n){return 60*n*1e3}function o(n){return"number"==typeof n?n-Date.now():0}function e(){var n;try{n=JSON.parse(localStorage[d])}catch(n){console.warn("Couldn't parse blocks JSON.")}return Array.isArray(n)||(t(n=[]),console.warn("Blocks were not an array.")),n}function t(n){for(var e=n.length-1;e>=0;e--)o(n[e][1])<=0&&n.splice(e,1);localStorage[d]=JSON.stringify(n)}function i(){if(f){var o=e(),i=n(s.storageBlockingMinutes);o.push([s.storageBlockingRegex,Date.now()+i]),t(o)}}function r(){if(!f)return!1;var n=!1;return e().forEach(function(e){var t=e[0],i=e[1];if(t===g||null!==new RegExp(t).exec(window.location.href)){var r=o(i);r>0&&(n=!0,"function"==typeof v.onStorageBlock&&v.onStorageBlock(t,r))}}),n}function c(){return!!v.enabled&&(!(!s.ignoreFlagBlocking&&v.activated)&&!(!s.ignoreStorageBlocking&&r()))}function u(n){"function"==typeof v.onAction&&!0===v.onAction(n)&&(v.activated=!0,i())}function l(n){"function"==typeof v.onTrigger&&v.onTrigger(n),!0===c()&&u(n)}function a(){s.bindEventBlur&&window.addEventListener("blur",l),s.bindEventMouseLeave&&document.documentElement.addEventListener("mouseleave",function(n){n.y<0&&l(n)}),s.bindEventMouseMove&&document.documentElement.addEventListener("mousemove",function(n){n.movementY<0&&(n.y<=0||n.movementY<-n.y)&&l(n)}),"function"==typeof v.onBound&&v.onBound()}var g="*",f="undefined"!=typeof localStorage,d="donleevBlocks",s={bindDelay:3e3,bindEventBlur:!0,bindEventMouseLeave:!0,bindEventMouseMove:!0,storageBlockingRegex:g,storageBlockingMinutes:10,ignoreStorageBlocking:!1,ignoreFlagBlocking:!1},v={options:s,enabled:!0,activated:!1,onBound:null,onTrigger:null,onStorageBlock:null,onAction:null};return v.setOptions=function(n){if("object"==typeof n&&null!==n)for(var o in n)s[o]=n[o]},v.init=function(n,o){"function"==typeof n&&(o=n,n=void 0),v.setOptions(n),v.onAction=o,ActiveTimeout.set(function(){a()},s.bindDelay)},v.purgeBlocks=function(n){f&&localStorage.donleevPurge!==n&&(localStorage.donleevPurge=n,t([]),console.warn("Blocks purged with string:",n))},v}();
